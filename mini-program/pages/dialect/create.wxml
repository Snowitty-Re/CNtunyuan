<view class="container">
  <view class="tips-card">
    <text class="tips-icon">ğŸ’¡</text>
    <text class="tips-text">è¯·å½•åˆ¶15-20ç§’çš„æ–¹è¨€è¯­éŸ³ï¼Œç”¨äºå¸®åŠ©è¯†åˆ«èµ°å¤±äººå‘˜å£éŸ³</text>
  </view>

  <view class="form-card">
    <view class="form-item">
      <text class="form-label">æ ‡é¢˜</text>
      <input class="form-input" placeholder="è¯·è¾“å…¥æ–¹è¨€æ ‡é¢˜" value="{{form.title}}" bindinput="onTitleInput" />
    </view>

    <view class="form-item">
      <text class="form-label">æè¿°</text>
      <textarea class="form-textarea" placeholder="æè¿°æ–¹è¨€å†…å®¹ã€èƒŒæ™¯ç­‰ï¼ˆé€‰å¡«ï¼‰" value="{{form.description}}" bindinput="onDescInput" />
    </view>

    <view class="form-item">
      <text class="form-label">å½•åˆ¶åœ°ç‚¹</text>
      <view class="location-picker" bindtap="chooseLocation">
        <text class="location-text">{{form.address}}</text>
        <text class="location-icon">ğŸ“</text>
      </view>
    </view>

    <view class="form-item">
      <text class="form-label">è¯¦ç»†åœ°å€</text>
      <input class="form-input" placeholder="çœ/å¸‚/åŒº/è¡—é“" value="{{form.detailAddress}}" bindinput="onAddressInput" />
    </view>
  </view>

  <!-- å½•éŸ³åŒºåŸŸ -->
  <view class="record-card">
    <view class="record-timer">{{recordTime}}s / 20s</view>
    
    <view class="record-area">
      <!-- å½•éŸ³åŠ¨ç”» -->
      <view class="record-waves" wx:if="{{isRecording}}">
        <view class="wave-item" wx:for="{{5}}" wx:key="index" style="animation-delay: {{index * 0.1}}s"></view>
      </view>

      <!-- æ’­æ”¾è¿›åº¦ -->
      <view class="play-progress" wx:if="{{hasRecorded && !isRecording}}">
        <progress percent="{{playProgress}}" stroke-width="4" activeColor="#1890ff" />
        <view class="time-display">{{currentTime}}s / {{recordDuration}}s</view>
      </view>

      <!-- å½•éŸ³æŒ‰é’® -->
      <view class="record-btn-wrapper">
        <view class="record-btn {{isRecording ? 'recording' : ''}} {{hasRecorded ? 'has-recorded' : ''}}" 
              bindtap="toggleRecord"
              bindlongpress="startRecord"
              bindtouchend="stopRecord"
              bindtouchcancel="stopRecord">
          <text class="record-icon">{{isRecording ? 'â¹' : (hasRecorded ? 'â–¶ï¸' : 'ğŸ¤')}}</text>
        </view>
        <text class="record-hint">{{isRecording ? 'æ¾å¼€ç»“æŸå½•éŸ³' : (hasRecorded ? 'ç‚¹å‡»æ’­æ”¾/é‡å½•' : 'é•¿æŒ‰å¼€å§‹å½•éŸ³')}}</text>
      </view>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="action-btns" wx:if="{{hasRecorded}}">
      <button class="btn-secondary" bindtap="reRecord">é‡æ–°å½•åˆ¶</button>
      <button class="btn-primary" bindtap="uploadRecord" loading="{{uploading}}">ä¸Šä¼ å½•éŸ³</button>
    </view>
  </view>

  <!-- å†å²å½•éŸ³ -->
  <view class="card" wx:if="{{myDialects.length > 0}}">
    <view class="card-header">
      <text class="card-title">æˆ‘çš„å½•éŸ³</text>
    </view>
    <view class="dialect-list">
      <view class="dialect-item" wx:for="{{myDialects}}" wx:key="id">
        <view class="dialect-info">
          <view class="dialect-title">{{item.title}}</view>
          <view class="dialect-meta">{{item.province}} {{item.city}} Â· {{item.duration}}ç§’</view>
        </view>
        <view class="dialect-status {{item.status}}">{{item.status === 'active' ? 'å·²é€šè¿‡' : 'å®¡æ ¸ä¸­'}}</view>
      </view>
    </view>
  </view>
</view>
