<view class="container">
  <map class="map" latitude="{{latitude}}" longitude="{{longitude}}" scale="{{scale}}" markers="{{markers}}" bindmarkertap="onMarkerTap" show-location>
    <!-- æœç´¢æ  -->
    <cover-view class="search-bar">
      <cover-view class="search-input">
        <cover-view class="search-icon">ğŸ”</cover-view>
        <cover-view class="search-text">æœç´¢åœ°ç‚¹</cover-view>
      </cover-view>
    </cover-view>

    <!-- åº•éƒ¨æ¡ˆä»¶åˆ—è¡¨ -->
    <cover-view class="case-panel" wx:if="{{showPanel}}">
      <cover-view class="panel-header">
        <cover-view class="panel-title">é™„è¿‘æ¡ˆä»¶ ({{nearbyCases.length}})</cover-view>
        <cover-view class="panel-close" bindtap="closePanel">âœ•</cover-view>
      </cover-view>
      <scroll-view scroll-y class="case-scroll">
        <cover-view class="case-item" wx:for="{{nearbyCases}}" wx:key="id" bindtap="goToCaseDetail" data-id="{{item.id}}">
          <cover-image class="case-photo" src="{{item.photos[0].url || '/assets/default-avatar.png'}}" />
          <cover-view class="case-info">
            <cover-view class="case-name">{{item.name}} {{item.age}}å²</cover-view>
            <cover-view class="case-distance">è·ç¦» {{item.distance}}km</cover-view>
            <cover-view class="case-location">{{item.missing_location}}</cover-view>
          </cover-view>
          <cover-view class="case-status {{item.status}}">{{statusMap[item.status]}}</cover-view>
        </cover-view>
      </scroll-view>
    </cover-view>

    <!-- å®šä½æŒ‰é’® -->
    <cover-view class="locate-btn" bindtap="locate">
      <cover-view class="locate-icon">ğŸ“</cover-view>
    </cover-view>

    <!-- æ¨¡å¼åˆ‡æ¢ -->
    <cover-view class="mode-switch">
      <cover-view class="mode-item {{mode === 'case' ? 'active' : ''}}" bindtap="switchMode" data-mode="case">æ¡ˆä»¶</cover-view>
      <cover-view class="mode-item {{mode === 'dialect' ? 'active' : ''}}" bindtap="switchMode" data-mode="dialect">æ–¹è¨€</cover-view>
    </cover-view>
  </map>
</view>
